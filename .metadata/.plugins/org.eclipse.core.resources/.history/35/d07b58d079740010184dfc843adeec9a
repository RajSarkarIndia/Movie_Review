package DAO;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.time.LocalDate;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;

@Repository
public class MovieRowMapper implements RowMapper<Movie> {

    @Override
    public Movie mapRow(ResultSet rs, int rowNum) throws SQLException {
        Movie movie = new Movie();
        MovieRepository mr=new MovieRepository();
        

        movie.setMovieID(rs.getInt("MovieID"));
        movie.setMovieName(rs.getString("MovieName"));
        movie.setGenre(rs.getString("Genre"));
        movie.setMovieRating(mr.CountRating(rs.getString("MovieName")));

        java.sql.Date sqlDate = rs.getDate("ReleaseDate");
        if (sqlDate != null) {
            movie.setReleaseDate(sqlDate.toLocalDate());
        }

        movie.setLength(rs.getInt("Length"));
        movie.setMovieImageURL(rs.getString("MovieImageURL"));

        return movie;
    }
}
